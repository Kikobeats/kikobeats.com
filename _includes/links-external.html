<script>
  if (document.addEventListener) document.addEventListener('click', onClick, false);
  else document.attachEvent('onclick', onClick);

  function onClick(event) {
    const link = (function () {
      if (event.target.tagName === 'A') return event.target
      const parent = event.target.parentElement.parentElement
      if (parent.tagName === 'A') return parent
    })()

  if (link.hostname != window.location.hostname) {
    link.target = '_blank';
    link.rel = 'noopener noreferrer';
  }

  localStorage.setItem(window.visited.KEY_PREFIX + link.href, true);
  window.visited()
  }

</script>
